<applications ng-controller="ApplicationsCtrl" ng-init="settings.applications = settings.applications || {date: getDate(), showdisabled: false}">
    <div class="row">
        <div class="col-md-12 resource-group">
            <div class="btn-toolbar" role="toolbar">
                <div class="btn-group">
                    <button type="button" class="btn btn-default" ng-click="newApi()">
                        <i class="icon-logo"></i> New API
                    </button>
                    <button type="button" class="btn btn-default">
                        <i class="fa fa-save"></i>
                    </button>
                    <button type="button" class="btn btn-default">
                        <i class="fa fa-cloud-upload"></i> Import
                    </button>
                    <div class="btn-group">
                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><i class="fa fa-filter"></i> Sort <span class="fa fa-angle-down"></span></button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href=""><i class="fa fa-sort-alpha-asc fa-fw"></i> Name</a></li>
                            <li><a href=""><i class="fa fa-fire fa-fw"></i> Activity</a></li>
                            <li><a href=""><i class="fa fa-calendar fa-fw"></i> Date</a></li>
                            <li class="divider"></li>
                            <li><a href="" ng-click="settings.applications.showdisabled=!settings.applications.showdisabled"><i class="fa fa-fw" ng-class="settings.applications.showdisabled ? 'fa-check-square' : 'fa-square-o'"></i> Show disabled</a></li>
                        </ul>
                    </div>
                </div>
            </div>

    <div class="row">
        <div class="col-md-12 resource-group">
            <div class="menu app-cards-row">
                <div ng-repeat="api in apis" ng-init="settings.applications[api._id] = {name: api.name}" class="menu-category" ng-show="settings.applications.showdisabled || api.enabled">
                    <div class="stock card" ng-init="flipped=false" ng-class="{flip: flipped, public: api.public}">
                        <div class="front">
                            <div class="stock-chart" ng-class="api.enabled ? 'enabled' : 'disabled'">
                                <bar-chart title="{{title}}" data="data"></bar-chart>
                                <line-chart title="{{title}}" data="api.logs" key="time"></line-chart>
                                <button class="btn api-setup pull-right" ng-click="flipped=!flipped"><i class="fa fa-cogs"></i></button>
                            </div>
                            <div class="current-price container">
                                <div class="info col-sm-6"><a href="#/main/applications/{{api.name}}"><abbr>{{api.name}}</abbr></a>
                                    <time><i class="fa fa-clock-o"></i> <span timeago="{{api.lastAccess}}"></span></time>
                                </div>
                                <div class="changes col-sm-6">
                                    <div class="value down">{{api.logs[api.logs.length-1].time}}ms</div>
                                    <div class="change">{{api.logs[api.logs.length-1].time - api.logs[api.logs.length-2].time}}ms ({{api.logs[api.logs.length-1].time / api.logs[api.logs.length-2].time * 100 | number:0}}%)</div>
                                </div>
                            </div>
                            <div class="yearly-changes container" ng-show="api.enabled">
                                <div class="year-all col-lg-6 col-sm-6"><strong ng-init="cosa=1000000">{{cosa | humanize}}</strong><span>Weekly change</span>
                                </div>
                                <div class="year-chart col-lg-6 col-sm-6">
                                    <ul class="chart-bars">
                                        <li data-value="35" data-title="January">
                                            <div class="value"></div>
                                            <label>Mo</label>
                                        </li>
                                        <li data-value="35" data-title="February">
                                            <div class="value"></div>
                                            <label>Tu</label>
                                        </li>
                                        <li data-value="35" data-title="March">
                                            <div class="value"></div>
                                            <label>We</label>
                                        </li>
                                        <li data-value="35" data-title="April">
                                            <div class="value"></div>
                                            <label>Th</label>
                                        </li>
                                        <li data-value="35" data-title="May">
                                            <div class="value"></div>
                                            <label>Fr</label>
                                        </li>
                                        <li data-value="35" data-title="June">
                                            <div class="value"></div>
                                            <label>Sa</label>
                                        </li>
                                        <li data-value="35" data-title="July">
                                            <div class="value"></div>
                                            <label>Su</label>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="summary container">
                                <div class="col-lg-6 col-sm-6" ng-init="0"><a><strong>{{api.logs.length || 0}}</strong><span>requests</span></a>
                                </div>
                                <div class="col-lg-6 col-sm-6" ng-init="0"><a><strong>{{api.meanTime || '&#x221e; '}}ms</strong><span>Average</span></a>
                                </div>
                            </div>
                        </div>
                        <div class="back">
                            <div class="settings panel panel-default">
                                <div class="panel-heading clearfix">
                                    <h4 class="panel-title pull-left" style="padding-top: 7.5px;"><i class="fa fa-sitemap"></i> {{api.name}}</h4>
                                    <div class="btn-group pull-right">
                                        <button class="btn btn-sm btn-default"><i class="fa fa-question-circle"></i></button>
                                        <button class="btn btn-sm btn-default" ng-click="flipped=!flipped"><i class="fa fa-share"></i></button>
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <form role="form" ng-model="account">
                                                <div class="form-group">
                                                    <label for="domain">API Domain</label>
                                                    <input type="text" class="form-control" id="domain" placeholder="domain" ng-model="api.domain">
                                                </div>
                                                <div class="form-group">
                                                    <label for="proxy">Global Proxy</label>
                                                    <div class="input-group">
                                                        <span class="input-group-addon">
                                                            <input type="checkbox">
                                                        </span>
                                                        <input type="text" class="form-control">
                                                    </div>
                                                </div>
                                                <div class="checkbox">
                                                    <label>Enable
                                                        <input type="checkbox" id="enable" ng-model="api.enabled">
                                                    </label>
                                                </div>
                                                <div class="checkbox">
                                                    <label>Public
                                                        <input type="checkbox" id="public" ng-model="api.public">
                                                    </label>
                                                </div>


                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <div class="form-group">
                                                            <button type="submit" class="btn btn-default">Submit</button>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <div class="form-group">
                                                            <button class="btn btn-danger pull-right"><i class="fa fa-trash-o"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="col-md-12">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 resource-group">
            <foot>
                <pagination ng-model="method" total-items="method.logs.length" items-per-page="10" page="currentPage" max-size="10" on-select-page="setPage(page)"></pagination>
            </foot>
        </div>
    </div>
</applications>

<script type="text/ng-template" id="new_api_modal.html">
    <form role="form" ng-model="api" ng-submit="submit()">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="cancel()"><i class="icon-close"></i></button>
            <h4 class="modal-title"><i class="icon-network"></i> {{ 'APPLICATIONS.NEWAPI.TITLE' | translate }}</h4>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="name">{{ 'APPLICATIONS.NEWAPI.NAME' | translate }}</label>
                <input type="text" class="form-control" id="name" placeholder="{{ 'APPLICATIONS.NEWAPI.NAME' | translate }}" required ng-required="true" ng-model="api.name">
            </div>
            <div class="form-group">
                <label for="domain">{{ 'APPLICATIONS.NEWAPI.DOMAIN' | translate }}</label>
                <input type="text" class="form-control" id="domain" placeholder="{{ 'APPLICATIONS.NEWAPI.DOMAIN' | translate }}" ng-model="api.domain">
            </div>
        </div>
        <div class="modal-footer">
            <button type="submit" class="btn btn-primary">{{ 'OK' | translate }}</button>
            <button type="button" class="btn btn-danger" ng-click="cancel()">{{ 'CANCEL' | translate }}</button>
        </div>
    </form>
</script>